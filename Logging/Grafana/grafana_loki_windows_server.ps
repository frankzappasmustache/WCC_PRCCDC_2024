172.29.0.5:502# Download and extract Loki binaries
Invoke-WebRequest -Uri "https://github.com/grafana/loki/releases/download/v2.5.0/loki-windows-amd64.zip" -OutFile "loki-windows-amd64.zip"
Expand-Archive -Path "loki-windows-amd64.zip" -DestinationPath "C:\loki"
Remove-Item "loki-windows-amd64.zip"

# Create a Loki configuration file
@"
auth_enabled: false
server:
  http_listen_port: 3100
"@ | Set-Content -Path "C:\loki\loki-local-config.yaml"

# Install Loki as a service
New-Service -Name "Loki" -BinaryPathName "C:\loki\loki-windows-amd64.exe -config.file=C:\loki\loki-local-config.yaml" -DisplayName "Loki" -StartupType Automatic

# Start the Loki service
Start-Service -Name "Loki"

Write-Host "Grafana Loki installation and configuration completed."
